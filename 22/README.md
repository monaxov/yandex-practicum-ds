# Спринт 22: Выпускной проект
## Создание прототипа модели машинного обучения для оптимизации энергозатрат металлургического предприятия в процессе выплавки легированной стали.

Целью настоящей работы было создание прототипа модели машинного обучения для прогноза конечной температуры расплава в процессе легирования стали для оптимизации энергозатрат на металлургическом предприятии.
В начале  работы были загружены и изучены данные по работе электродов, датчиков температуры, бункеров сыпучих материалов и трайб-аппарата, подаче  инертного газа.
В ходе исследовательского анализа было подтверждено, что технологический процесс протекает не вполне оптимально и разработка инструмента для лучшего контроля за ним оправдана.
Далее был составлен план действий, реализованный на последующих шагах с изложенными ниже результатами:
1. Данные были сведены в один общий датасет, при этом было осуществлено:
    1. именование признаков в стандартном виде
    2. удаление отсутствующих в некоторых таблицах ключей
    3. удаление аномалий по заданным условиям
    4. заполнение пропусков нулевыми значениями
    5. добавление вычисляемых признаков на основе имеющихся
    6. агрегация значений признаков на различных итерациях в единое для одного ключа с помощью набора функций
2. Был выделен целевой признак и данные были разделены на обучающую и тестовую выборки в заданной по условию задания пропорции
3. Был введен порог вменяемости в виде средней абсолютной ошибки для  среднего значения целевого признака в обучающей выборке и целевого признака в тестовой выборке
4. Для модели на основе алгоритма гребневой регрессии была осуществлена попытка отбора признаков, для чего:
    1. была исследована структура мультиколинеарности имеющихся признаков
    2. были найдены наиболее важные признаки на основе пермутации
    3. различными способами было выделено подмножество признаков с меньшей степенью взаимосвязанности и/или с большим влиянием каждого из них на качество работы модели
    4. в конечном итоге все эти мероприятия не дали ощутимого прироста качества модели и были найдены избыточными
5. На основе алгоритма изолирующего леса были найдены и удалены выбросы, что дало некоторый прирост качества работы как модели гребневой регрессии, так и введенной на данном этапе модели на основе градиентного бустинга
6. Была проведена настройка  гиперпараметров обеих моделей, в случае с гребневой регрессией не давшая ощутимых результатов (значение коэффициента регуляризации 1.358196270465704)
7. Были сравнены результаты работы  обеих моделей с помощью  кросс-валидации на обучающей выборке, что позволило сделать следующие выводы:
    1. Среднее качество работы обеих моделей по метрике MAE на валидационных фрагментах различается несущественно
    2. модель на основе гребневой регрессии практически не переобучается (близкие средние значения MAE на обучающих (5.394023) и валидационных (5.572862) фрагментах
    3. у модели на основе гребневой регрессии стандартное отклонение на валидационных фрагментахменьше такового  у модели на основе градиентного бустинга: 0.345731 против 0.431012
    4. модель на основе гребневой регрессии работает значительно быстрее (средняя скорость обучения и прогнозирования 0.013858 и 0.004132 соответственно против 4.458170 и 0.028530)
8. Учитывая эти моменты наряду с тем, что обе модели дают необходимый уровень точности по условию задания, в итоге была выбрана модель на основе алгоритма гребневой регрессии  - с коэффициентом регуляризации 1.358196270465704, обученная на тренировочных данных с удаленными ввыбросами без масштабирования. 
9. Было проведено финальное тестирование на заранее отобранной случайным образом проверочной выборке, которое полностью подтвердило работоспособность выбранной модели (значение MAE 5.9573122796560884)
